# 七輪アーカイブ 要件定義書

## 1. プロジェクト概要

「七輪アーカイブ」は、aikoコピーバンド「七輪」の活動記録を管理・閲覧するためのウェブアプリケーションです。2003年から現在までの演奏ライブ、セットリスト、演奏統計を検索・閲覧できる静的ウェブサイトとして実装されています。

## 2. 目的

- aikoコピーバンド「七輪」の活動記録を一元管理する
- ライブごとのセットリスト情報を整理・検索可能にする
- 楽曲の演奏頻度や傾向を可視化する
- YouTubeなどの動画リンクと連携し、過去のパフォーマンスを視聴できるようにする
- 静的サイトとして生成し、AWSなどのクラウドサービスで低コスト運用する

## 3. 対象ユーザー

- 七輪のメンバー（管理者）
- 七輪のライブを観に来るファン
- aikoファン
- バンド活動に興味のある一般ユーザー

## 4. 機能要件

### 4.1 ページ構成

| ページ名 | 機能概要 | 実装状況 |
|--------|---------|---------|
| ホーム | サイト全体の概要と各機能へのナビゲーション | 実装済み |
| ライブとセトリ検索 | ライブおよび楽曲の詳細検索機能 | 実装済み |
| ライブ詳細 | 特定ライブの詳細情報とセットリスト表示 | 実装済み |
| 楽曲詳細 | 特定楽曲の詳細情報と演奏履歴表示 | 実装済み |
| 演奏統計 | 演奏に関する統計情報のダッシュボード | 実装済み |
| ヒートマップ | 楽曲の演奏頻度を時系列で可視化 | 実装済み |

### 4.2 ヘッダー・グローバルナビゲーション

- メインページへのリンク（ホーム、ライブとセトリ、演奏統計、ヒートマップ）
- パンくずリスト表示（設定により切り替え可能）
  - 履歴モード：訪問したページの履歴を表示
  - 階層モード：現在のページの階層構造を表示

### 4.3 検索機能

- キーワード検索：ライブ名、会場名、曲名などでの検索
- 会場フィルター：特定の会場で行われたライブのみ表示
- 期間フィルター：ライブの開催年で絞り込み
- アルバムフィルター：特定のアルバムに収録された楽曲で絞り込み
- 演奏回数フィルター：特定の回数以上/以下演奏された曲で絞り込み
- YouTube動画フィルター：YouTube動画がある演奏のみ表示

### 4.4 ライブ詳細表示機能

- ライブの基本情報表示（日付、イベント名、会場名、メモ）
- セットリスト表示（演奏順、曲名、アルバム情報）
- YouTube動画埋め込み機能（動画がある曲のみ）
- 前後のライブへのナビゲーションリンク

### 4.5 楽曲詳細表示機能

- 楽曲の基本情報表示（曲名、アルバム、リリース日）
- 楽曲の演奏統計（演奏回数、初演奏日、最終演奏日）
- 年別演奏回数のグラフ表示
- 演奏ライブの履歴リスト

### 4.6 演奏統計機能

- 演奏回数Top10曲のランキング
- アルバム別演奏曲分布
- 年別ライブ回数の推移グラフ
- 会場別ライブ回数ランキング
- 統計サマリー（総ライブ回数、演奏楽曲数、平均セットリスト曲数など）
- 期間フィルター機能

### 4.7 ヒートマップ機能

- 楽曲と時期のマトリックスによる演奏頻度の可視化
- 年別/四半期別の時間単位切り替え
- 表示曲数の制限設定
- 並び替え機能（演奏回数順、曲名順、アルバム順、最終演奏日順、リリース順）
- 年範囲フィルター
- コンパクト表示モード（モバイル対応）
- セル詳細表示（特定楽曲の特定期間の演奏ライブリスト）

### 4.8 YouTube動画連携機能

- セットリスト内の各曲にYouTube動画リンクを登録可能
- 埋め込みプレーヤーによる動画視聴
- タイムスタンプ対応（特定時間からの再生）
- プレビューモードと埋め込みモードの切り替え
- 外部YouTubeへのリンク

## 5. 非機能要件

### 5.1 パフォーマンス要件

- 静的サイト生成（SSG）による高速な読み込み
- ページごとの静的HTML生成
- データの効率的なキャッシング
- レスポンシブデザイン（モバイル対応）
- ビルド時間の最適化

### 5.2 データ管理要件

- YAML形式でのマスターデータ管理
- TSV形式への変換機能（スプレッドシート編集用）
- データ整合性の検証機能
- リンク確認機能

### 5.3 ホスティング要件

- AWS Amplifyでの静的サイトホスティング
- リダイレクト設定
- ルートパスへのフォールバック設定

## 6. データモデル

### 6.1 ライブデータ (Live)

- id: ライブID（例: live001）
- eventId: イベントID（数値）
- date: 開催日（YYYY-MM-DD形式）
- eventName: イベント名
- venueName: 会場名
- memo: メモ（任意）

### 6.2 楽曲データ (Song)

- id: 楽曲ID（例: song001）
- title: 曲名
- album: 主アルバム名
- releaseDate: リリース日
- trackNumber: トラック番号
- isSingle: シングル曲かどうか

### 6.3 セットリストデータ (SetlistItem)

- liveId: ライブID（外部キー）
- songId: 楽曲ID（外部キー）
- order: 演奏順
- type: 形態（'individual'/'medley'）
- memo: メモ
- youtubeUrl: YouTube URL（任意）

### 6.4 アルバムデータ (Album)

- id: アルバムID（例: album001）
- title: アルバム名
- category: カテゴリ（アルバム/シングル）
- subCategory: サブカテゴリ（メジャー/インディーズ/ベスト）
- releaseDate: リリース日

### 6.5 アルバム収録曲データ (AlbumTrack)

- albumId: アルバムID（外部キー）
- songId: 楽曲ID（外部キー）
- trackNumber: トラック番号

## 7. 技術要件

### 7.1 開発環境

- Node.js v18以上
- Git（バージョン管理）

### 7.2 フロントエンド

- Next.js（App Routerアーキテクチャ）
- React 19
- TypeScript
- Tailwind CSS（スタイリング）
- Recharts（グラフ表示）
- Lucide React（アイコン）

### 7.3 データ処理

- js-yaml（YAMLパーサー）
- Static Site Generation (SSG)
- クライアントサイドでのデータフィルタリング

### 7.4 デプロイ

- AWS Amplify
- 静的出力設定（output: 'export'）

## 8. 実装フェーズ

### 8.1 完了したフェーズ

- フェーズ1: 不要コンポーネントの整理
- フェーズ2: ライブ個別ページの実装
- フェーズ3: 楽曲個別ページの実装
- フェーズ4: リンク統合とナビゲーション更新
- フェーズ5: データ管理システムの改善
- フェーズ6: コンポーネントリファクタリング
- フェーズ7: YouTube動画検索機能の実装

### 8.2 次に実装するフェーズ

- フェーズ8: パフォーマンス最適化
  - データ取得の最適化
  - レンダリングパフォーマンスの改善
  - バンドルサイズの最適化
- フェーズ9: AWS Amplifyデプロイ対応
  - AWS Amplifyの設定
  - リダイレクト設定
  - ビルドパフォーマンス最適化

## 9. 制約条件

- 静的サイト生成のみを使用（サーバーサイドの処理は不可）
- すべてのデータ操作はクライアントサイドで行う
- 外部APIの使用は不可（YouTubeの埋め込みは例外）
- データの更新はビルド時のみ（リアルタイム更新は不要）
- すべての画面でモバイル対応が必要

## 10. 今後の拡張可能性

- 埋め込み設定の保存（YouTubeの表示/非表示設定）
- YouTube再生リスト対応
- アクセシビリティ向上
- パフォーマンス最適化（動画プレビュー画像の表示）
- オフライン対応
- PWA化
